project("a") {
  task test {
    dependsOn "testClasses"
    dependsOn ":b:jar"
    dependsOn "classes"
    finalizedBy ":someTaskThatFinalizeJavaTestTask"
  }
  
  task testClasses {
    dependsOn "processTestResources"
    dependsOn "compileTestJava"
  }
  
  task processTestResources {}
  
  task compileTestJava {
    dependsOn ":b:jar"
    dependsOn "classes"
  }
  
  task classes {
    dependsOn "compileJava"
    dependsOn "processResources"
  }
  
  task compileJava {
    dependsOn ":b:jar"
  }
  
  task processResources {}
  
  task jar {
    dependsOn "classes"
  }
}

project("b") {
  task jar {
    dependsOn "classes"
  }
  
  task classes {
    dependsOn "compileJava"
    dependsOn "processResources"
  }
  
  task compileJava {}
  
  task processResources {
    dependsOn ":someTaskThatGenerateJavaResources"
  }
  
  task test {
    dependsOn ":a:jar"
    dependsOn "jar"
    dependsOn "testClasses"
    finalizedBy ":someTaskThatFinalizeJavaTestTask"
  }
  
  task testClasses {
    dependsOn "processTestResources"
    dependsOn "compileTestJava"
  }
  
  task processTestResources {}
  
  task compileTestJava {
    dependsOn ":a:jar"
    dependsOn "jar"
    dependsOn "classes"
  }
}

task someTaskThatFinalizeJavaTestTask {
  finalizedBy "lintGradle"
}

task someTaskThatGenerateJavaResources {
  finalizedBy "lintGradle"
}

task lintGradle {}

