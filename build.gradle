project("a") {
  task test {
    dependsOn "compileTestJava"
    dependsOn "classes"
    finalizedBy ":someTaskThatFinalizeJavaTestTask"
  }
  
  task compileTestJava {
    dependsOn ":b:jar"
  }
  
  task classes {
    dependsOn ":b:jar"
  }
  
  task compileJava {
    dependsOn ":b:jar"
  }
}

project("b") {
  task jar {
    dependsOn ":someTaskThatGenerateJavaResources"
  }
  
  task test {
    dependsOn ":a:classes"
    dependsOn "compileTestJava"
    finalizedBy ":someTaskThatFinalizeJavaTestTask"
  }
  
  task compileTestJava {
    dependsOn "jar"
  }
}

task someTaskThatFinalizeJavaTestTask {
  finalizedBy "lintGradle"
}

task someTaskThatGenerateJavaResources {
  finalizedBy "lintGradle"
}

task lintGradle {}

